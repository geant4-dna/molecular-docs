<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Geometry Model - Molecular DNA</title> <link rel="shortcut icon" href="/molecular-docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/molecular-docs/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/molecular-docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/molecular-docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Geometry Model | Molecular DNA</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Geometry Model" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Molecular DNA is a program to run radiation-induced DNA damage simulations in Geant4." /> <meta property="og:description" content="Molecular DNA is a program to run radiation-induced DNA damage simulations in Geant4." /> <link rel="canonical" href="https://natl.github.io/molecular-docs/docs/geometry-model" /> <meta property="og:url" content="https://natl.github.io/molecular-docs/docs/geometry-model" /> <meta property="og:site_name" content="Molecular DNA" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Geometry Model" /> <script type="application/ld+json"> {"description":"Molecular DNA is a program to run radiation-induced DNA damage simulations in Geant4.","url":"https://natl.github.io/molecular-docs/docs/geometry-model","@type":"WebPage","headline":"Geometry Model","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://natl.github.io/molecular-docs/" class="site-title lh-tight"> Molecular DNA </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://natl.github.io/molecular-docs/" class="nav-list-link">Home</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://natl.github.io/molecular-docs/docs/overview" class="nav-list-link">Overview</a><ul class="nav-list "><li class="nav-list-item "><a href="https://natl.github.io/molecular-docs/docs/overview/macro-anatomy" class="nav-list-link">Molecular-DNA Macro Files</a></li><li class="nav-list-item active"><a href="https://natl.github.io/molecular-docs/docs/geometry-model" class="nav-list-link active">Geometry Model</a></li><li class="nav-list-item "><a href="https://natl.github.io/molecular-docs/docs/overview/physics-model.html" class="nav-list-link">Physics Model</a></li><li class="nav-list-item "><a href="https://natl.github.io/molecular-docs/docs/overview/damage-model.html" class="nav-list-link">Damage Model</a></li><li class="nav-list-item "><a href="https://natl.github.io/molecular-docs/docs/overview/chemistry-model.html" class="nav-list-link">Chemistry Model</a></li><li class="nav-list-item "><a href="https://natl.github.io/molecular-docs/docs/overview/configuration" class="nav-list-link">Configuration Glossary</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://natl.github.io/molecular-docs/docs/geometry-library" class="nav-list-link">Geometry Library</a><ul class="nav-list "></ul></li><li class="nav-list-item"><a href="https://natl.github.io/molecular-docs/docs/source.html" class="nav-list-link">Running from Source</a></li><li class="nav-list-item"><a href="https://natl.github.io/molecular-docs/docs/publications.html" class="nav-list-link">Publications</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Molecular DNA" aria-label="Search Molecular DNA" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/natl/molecular-docs" class="site-button" > Molecular-DNA on GitHub </a> </li> <li class="aux-nav-list-item"> <a href="http://geant4-dna.in2p3.fr/index.html" class="site-button" > The Geant4-DNA Project </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://natl.github.io/molecular-docs/docs/overview">Overview</a></li> <li class="breadcrumb-nav-list-item"><span>Geometry Model</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="geometry-model"> <a href="#geometry-model" class="anchor-heading" aria-labelledby="geometry-model"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Geometry Model </h1> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#design-principal" id="markdown-toc-design-principal">Design Principal</a></li> <li><a href="#dna-placements" id="markdown-toc-dna-placements">DNA Placements</a> <ol> <li><a href="#specifying-molecule-sizes" id="markdown-toc-specifying-molecule-sizes">Specifying Molecule Sizes</a></li> <li><a href="#defining-dna-placements" id="markdown-toc-defining-dna-placements">Defining DNA Placements</a></li> <li><a href="#considerations-for-base-pairs" id="markdown-toc-considerations-for-base-pairs">Considerations for Base Pairs</a></li> </ol> </li> <li><a href="#geometry-placements" id="markdown-toc-geometry-placements">Geometry Placements</a></li> <li><a href="#physics-and-chemistry-considerations" id="markdown-toc-physics-and-chemistry-considerations">Physics and Chemistry Considerations</a></li> </ol> <h2 id="design-principal"> <a href="#design-principal" class="anchor-heading" aria-labelledby="design-principal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Design Principal </h2> <p>Molecular-DNA was made to make it easy to define a DNA geometry, and then place it repeatedly to model a complex geometry at large scales, as below.</p> <p class="text-center"><img src="/assets/images/placements-export.svg" alt="Placements for DNA Geometries" /></p> <p>There are two important notions when we define the geometry, <em>placement definitions</em> and the <em>geometry defintion</em>, often called the <em>fractal definition</em> as it is often seeded with a fractal.</p> <ul> <li><em>Placement Definition</em> defines the small scale structure of the simulation.</li> <li><em>Geometry Definition</em> defines the large scale structure of the simulation.</li> </ul> <p>Some examples of how to make these files are available on <a href="https://github.com/natl/fractaldna">github</a>, and examples can be downloaded from the <a href="https://natl.github.io/docs/geometry-library">Geometry Library</a></p> <h2 id="dna-placements"> <a href="#dna-placements" class="anchor-heading" aria-labelledby="dna-placements"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DNA Placements </h2> <p>DNA Placements are the low level building block of the DNA geometry and show how the DNA sits in a given segment of DNA.</p> <h3 id="specifying-molecule-sizes"> <a href="#specifying-molecule-sizes" class="anchor-heading" aria-labelledby="specifying-molecule-sizes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Specifying Molecule Sizes </h3> <h3 id="defining-dna-placements"> <a href="#defining-dna-placements" class="anchor-heading" aria-labelledby="defining-dna-placements"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Defining DNA Placements </h3> <p>The molecular structure files must follow a pattern for specifying base pairs. The units of this file are <strong>angstroms</strong> They are loaded and named via</p> <p><code class="language-plaintext highlighter-rouge">/dnageom/placementVolume turntwist geometries/turned_twisted_solenoid_750.txt true</code></p> <p>or more generally,</p> <p><code class="language-plaintext highlighter-rouge">/dnageom/placementVolume name path twist</code></p> <p>Where twist is true only if the DNA leaves the region it is placed in twisted.</p> <p>First, we specify the columns as follows:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME SHAPE CHAIN_ID STRAND_ID BP_INDEX SIZE_X SIZE_Y SIZE_Z POS_X POS_Y POS_Z ROT_X ROT_Y ROT_Z
</code></pre></div></div> <p>The base pair molecules should be ordered in the following way:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAME          ... CHAIN_ID STRAND_ID BP_INDEX
Phosphate         0        0         0
Sugar             0        0         0
Base              0        0         0
Phosphate         0        1         0
Sugar             0        1         0
Base              0        1         0
Phosphate         0        0         1
Sugar             0        0         1
Base              0        0         1
Phosphate         0        1         1
Sugar             0        1         1
Base              0        1         1
Phosphate         0        0         2
Sugar             0        0         2
Base              0        0         2
Phosphate         0        1         2
Sugar             0        1         2
Base              0        1         2
Phosphate         1        0         1
Sugar             1        0         1
Base              1        0         1
</code></pre></div></div> <p>For example:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># NAME SHAPE CHAIN_ID STRAND_ID BP_INDEX SIZE_X SIZE_Y SIZE_Z POS_X POS_Y POS_Z ROT_X ROT_Y ROT_Z
Phosphate sphere 0 0 0 2.28235386685 2.28235386685 2.28235386685 -0.779890171626 8.81558497913 -354.765866667 0.0 -0.0 0.0
Sugar sphere 0 0 0 2.6321398256 2.6321398256 2.6321398256 2.25982239097 6.73743447392 -355.665858586 0.0 -0.0 0.0
Adenine ellipse 0 0 0 3.43071072475 3.74350414063 1.93195792885 -0.361457926445 3.55954727504 -356.525238095 0.0 -0.0 0.0
Phosphate sphere 0 1 0 2.28235386685 2.28235386685 2.28235386685 -0.779890171626 -8.81558497913 -359.034133333 0.0 -0.0 0.0
Sugar sphere 0 1 0 2.6321398256 2.6321398256 2.6321398256 2.25982239097 -6.73743447392 -358.134141414 0.0 -0.0 0.0
Thymine ellipse 0 1 0 4.20594307927 3.04044782148 2.00335871121 0.341921252673 -2.52650922939 -357.1434375 0.0 -0.0 0.0
Phosphate sphere 0 0 1 2.28235386685 2.28235386685 2.28235386685 -5.61207771304 6.84305128922 -351.445866667 0.0 -0.0 0.598647933434
Sugar sphere 0 0 1 2.6321398256 2.6321398256 2.6321398256 -1.92988440602 6.83925191147 -352.345858586 0.0 -0.0 0.598647933434
Cytosine ellipse 0 0 1 3.59734130793 3.06633133132 1.77936085548 -1.85431408781 2.78220301495 -353.241181102 0.0 -0.0 0.598647933434
Phosphate sphere 0 1 1 2.28235386685 2.28235386685 2.28235386685 4.32354583169 -7.72202814327 -355.714133333 0.0 -0.0 0.598647933434
Sugar sphere 0 1 1 2.6321398256 2.6321398256 2.6321398256 5.66355525211 -4.2923143449 -354.814141414 0.0 -0.0 0.598647933434
Guanine ellipse 0 1 1 3.63150302541 3.79995327655 1.88728803748 1.8106255578 -1.57510975134 -353.791781609 0.0 -0.0 0.598647933434
Phosphate sphere 0 0 2 2.28235386685 2.28235386685 2.28235386685 -8.49236548301 2.49048101922 -348.125866667 0.0 -0.0 1.19729586687
Sugar sphere 0 0 2 2.6321398256 2.6321398256 2.6321398256 -5.44837082374 4.56235420546 -349.025858586 0.0 -0.0 1.19729586687
Guanine ellipse 0 0 2 3.63150302541 3.79995327655 1.88728803748 -1.93957822803 1.41328409623 -350.048218391 0.0 -0.0 1.19729586687
</code></pre></div></div> <p>The order Phosphate - Sugar - Base must always be kept. Each chain is specified completely before a new chain starts, and base pair sections are specified in their entirety before a new base pair section is specified.</p> <p>This is done to enable the file to be read in such that their is a fixed distance between any molecule and its neighbours. This facilitates the cutting of certain shapes within Geant4 so that each shape can be represented with the maximum volume possible.</p> <p>The relevant spaces needed in finding neighbouring molecules are for a molecule at position P:</p> <ul> <li>Base Pair, strand ID 0: Sugar at P-1, base at P+3, base at P-6</li> <li>Base Pair, strand ID 1: Sugar at P-1, base at P-3, base at P-6</li> <li>Sugar: Phosphate at P-1</li> <li>Phosphate: Sugar at P+5</li> </ul> <h3 id="considerations-for-base-pairs"> <a href="#considerations-for-base-pairs" class="anchor-heading" aria-labelledby="considerations-for-base-pairs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Considerations for Base Pairs </h3> <p>The fundamental base pair geometry that is used should be aligned (where possible) with the DNA helix aligned with the Z axis. Base pairs are hard-coded to have a maximum half-height of 0.17 nm in the case where the vertical semi-axis is larger than this. Additionally, if the base pairs were to overlap, they are rescaled to eliminate any chance of this. Whilst this reduces the volume in the simulation that can be considered as containing “base pairs”, it only marginally affects the simulation.</p> <h2 id="geometry-placements"> <a href="#geometry-placements" class="anchor-heading" aria-labelledby="geometry-placements"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Geometry Placements </h2> <p>DNA motif files are placed according to whatever specified in the input definition file. This file looks as follows</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#IDX KIND POS_X POS_Y POS_Z EUL_PSI EUL_THETA EUL_PHI
0 straight 0.0 0.0 0.0 0.0 -0.0 0.0
1 turn 0.0 0.0 1.0 0.0 -0.0 1.57079632679
2 turn 0.0 1.0 1.0 -1.57079632679 1.57079632679 0
3 turntwist -0.0 1.0 0.0 3.14159265359 -0.0 0.0
4 turn 1.0 1.0 -0.0 -3.14159265359 -1.57079632679 0
5 turntwist 1.0 1.0 1.0 0.0 -0.0 -1.57079632679
6 turn 1.0 0.0 1.0 1.57079632679 1.57079632679 0
7 straight 1.0 0.0 -0.0 3.14159265359 -0.0 0.0
</code></pre></div></div> <p>Here, three motif files are placed at the positions indicated, and rotated as indicated.</p> <p>X, Y and Z positions can be given scalings or units with the command</p> <p><code class="language-plaintext highlighter-rouge">/dnageom/fractalScaling 1 1 1 nm # file is in nm</code></p> <p><code class="language-plaintext highlighter-rouge">/dnageom/fractalScaling 50 50 50 nm # scale each unit to 50 nm blocks</code></p> <p>Files are loaded via:</p> <p><code class="language-plaintext highlighter-rouge">/dnageom/definitionFile geometries/cube-centred-X-7.txt # or another path</code></p> <p>Motif files are named when they are loaded via macro commands.</p> <h2 id="physics-and-chemistry-considerations"> <a href="#physics-and-chemistry-considerations" class="anchor-heading" aria-labelledby="physics-and-chemistry-considerations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Physics and Chemistry Considerations </h2> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Built using <a href="https://github.com/pmarsceill/just-the-docs">Just The Docs</a>.</p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
